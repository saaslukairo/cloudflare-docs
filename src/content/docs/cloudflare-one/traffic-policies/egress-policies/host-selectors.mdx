---
pcx_content_type: configuration
title: Host selectors
sidebar:
  order: 2
---

import { Tabs, TabItem, Details, APIRequest } from "~/components";

<Details header="Feature availability">

| [WARP modes](/cloudflare-one/team-and-resources/devices/warp/configure-warp/warp-modes/) | [Zero Trust plans](https://www.cloudflare.com/teams-pricing/) |
| ---------------------------------------------------------------------------------------- | ------------------------------------------------------------- |
| Gateway with WARP                                                                        | Enterprise                                                    |

| System   | Availability | Minimum WARP version |
| -------- | ------------ | -------------------- |
| Windows  | ✅           | 2025.4.929.0         |
| macOS    | ✅           | 2025.4.929.0         |
| Linux    | ✅           | 2025.4.929.0         |
| iOS      | ❌           |                      |
| Android  | ❌           |                      |
| ChromeOS | ❌           |                      |

</Details>

When Gateway receives a DNS query for hostname covered by the [Application](/cloudflare-one/traffic-policies/egress-policies/#application), [Content Categories](/cloudflare-one/traffic-policies/egress-policies/#content-categories), [Domain](/cloudflare-one/traffic-policies/egress-policies/#domain), and [Host](/cloudflare-one/traffic-policies/egress-policies/#host) selectors in an Egress policy, Gateway initially resolves DNS to an IP in the `100.80.0.0/16` or `2606:4700:0cf1:4000::/64` range. This process allows Gateway to map a destination IP with a hostname at [layer 4](https://www.cloudflare.com/learning/ddos/glossary/open-systems-interconnection-model-osi/) (where Gateway evaluates Egress policies). The destination IP for a hostname is not usually known at layer 4. Prior to evaluating Egress policies, the initially resolved IP is overwritten with the correct destination IP.

![Example egress policy flow](~/assets/images/cloudflare-one/policies/host-selector-diagram.png)

Additional configuration is required when using policies with these selectors.

## Turn on Host selectors

To turn on the selectors for your account:

<Tabs syncKey="dashPlusAPI"> <TabItem label="Dashboard">

1. In [Cloudflare One](https://one.dash.cloudflare.com/), go to **Traffic policies** > **Traffic settings**.
2. In **Policy settings**, turn on **Allow egress policy host selectors**.

</TabItem> <TabItem label="API">

Use the [Patch Zero Trust account configuration](/api/resources/zero_trust/subresources/gateway/subresources/configurations/methods/edit/) endpoint to update your Zero Trust configuration. For example:

<APIRequest
	path="/accounts/{account_id}/gateway/configuration"
	method="PATCH"
	json={{
		settings: {
			host_selector: {
				enabled: true,
			},
		},
	}}
/>

</TabItem> </Tabs>

## Prerequisites

Traffic must be on-ramped to Gateway with the following methods:

| On-ramp method                                                                                      | Compatibility |
| --------------------------------------------------------------------------------------------------- | ------------- |
| [WARP](/cloudflare-one/team-and-resources/devices/warp/)                                            | ✅            |
| [PAC files](/cloudflare-one/team-and-resources/devices/agentless/pac-files/)                        | ✅            |
| [Browser Isolation](/cloudflare-one/remote-browser-isolation/)                                      | ✅            |
| [WARP Connector](/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-connector/) | ❌            |
| [Magic WAN](/magic-wan/zero-trust/cloudflare-gateway/)                                              | ❌            |

Unsupported traffic will be resolved with your default Gateway settings. If you use DNS locations to send a DNS query to Gateway with IPv4, IPv6, DoT, or DoH, Gateway will not return the initial resolved IP for supported traffic nor resolve unsupported traffic.

### Configuration changes

:::caution
Gateway will overwrite the DNS response for all supported traffic, even if you use identity or device posture selectors to limit which users or devices are affected by the policy. In these cases, while the DNS response is overwritten, Gateway will still apply the correct Egress policy. Therefore, the configuration changes below must be applied to all of your users and device profiles.
:::

To configure your Zero Trust organization to use Host selectors with Egress policies:

1.  Ensure you have deployed [WARP version 2025.4.929.0](/cloudflare-one/team-and-resources/devices/warp/download-warp/) or later on your users' desktop devices. If you need to apply your policies to mobile devices or devices running a version of WARP prior to 2025.4.929.0, add and deploy the following key-value pair to your devices' [WARP configuration file](/cloudflare-one/team-and-resources/devices/warp/deployment/mdm-deployment/) (`mdm.xml` on Windows and Linux or `com.cloudflare.warp.plist` on macOS):

    ```diff lang="xml"
    <array>
    	<dict>
    +		<key>doh_in_tunnel</key>
    +		<true/>
    	</dict>
    </array>
    ```

{/* prettier-ignore-start */}

2.  In your WARP [device profile](/cloudflare-one/team-and-resources/devices/warp/configure-warp/device-profiles/), configure [Split Tunnels](/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/) depending on the mode:

    <Tabs> <TabItem label="Exclude IPs and domains">
		1. [Remove the route](/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#remove-a-route) to the IP address `100.64.0.0/10` from your Split Tunnel exclude list.
		2. We recommend [adding back the IPs](/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/cloudflared/connect-cidr/#3-route-private-network-ips-through-warp) that are not being used for Zero Trust services. For example, if you are using Gateway host selectors alongside [WARP-to-WARP connectivity](/cloudflare-one/networks/connectors/cloudflare-tunnel/private-net/warp-to-warp/) add routes to exclude the following IP addresses:
			- `100.64.0.0/12`
			- `100.81.0.0/16`
			- `100.82.0.0/15`
			- `100.84.0.0/14`
			- `100.88.0.0/13`
			- `100.112.0.0/12`

    </TabItem> <TabItem label="Include IPs and domains">
		1. Add the required [Zero Trust domains](/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-domains) or [IP addresses](/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#cloudflare-zero-trust-ip-addresses) to your Split Tunnel include list.
		2. [Add a route](/cloudflare-one/team-and-resources/devices/warp/configure-warp/route-traffic/split-tunnels/#add-a-route) to include `100.80.0.0/16`.

    </TabItem> </Tabs>

The WARP client must be set to _Gateway with WARP_ mode for traffic affected by these selectors to route correctly.

{/* prettier-ignore-end */}

## Known issues

### Google Chrome restricts local network access

Starting with [Chrome 142](https://developer.chrome.com/release-notes/142), the browser restricts requests from websites to local IP addresses, including the CGNAT range (`100.80.0.0/16`) used by the Host selector. When a website attempts to access a domain covered by a Gateway policy with a Host selector, the browser will display a prompt from the website asking to look for and connect to devices on the local network. Chrome will block requests to domains covered by Host selectors until the user accepts this prompt.

To avoid this issue, choose one of the following options:

- Disable the Chrome feature flag: Go to `chrome://flags` and set the **Local Network Access Checks** flag to _Disabled_.
- Configure Chrome Enterprise policy: Use the **LocalNetworkAccessAllowedForUrls** policy to allow specific websites to make requests to domains covered by Host selectors. For more information, refer to the [Chrome Enterprise documentation](https://chromeenterprise.google/policies/#LocalNetworkAccessAllowedForUrls).
