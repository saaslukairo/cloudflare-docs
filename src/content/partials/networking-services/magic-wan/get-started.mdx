---
params:
  - productNameManual
  - productNameConnector
  - configureConnectorUrl
  - configureMwanManually
  - greReferenceURL
  - ipsecReferenceUrl
  - ipsecReferenceConfigParams
  - mtuReferenceURL
---

import { GlossaryTooltip, Render } from "~/components";

{props.productNameManual} allows you to achieve any-to-any connectivity across branch and retail sites and data centers, with Cloudflare connectivity cloud.

## Before you begin

{props.productNameManual} is an Enterprise-only product. [Contact Cloudflare](https://www.cloudflare.com/magic-wan/) to acquire {props.productNameManual}. If you plan on using {props.productNameConnector} to automatically onboard your locations to Cloudflare, you will need to purchase {props.productNameManual} first.

## Set up method

{props.productNameManual} supports an automatic setup and a manual setup. The automatic setup through {props.productNameConnector} is the preferred method.

### Automatic set up

Setting up {props.productNameManual} automatically is done through {props.productNameConnector}, and is the preferred method. You can choose between the hardware version and the virtual version of {props.productNameConnector}. The virtual version can be installed on your own machines.

If you plan on using {props.productNameConnector}, you can skip the prerequisites below, and refer to <a href={props.configureConnectorUrl}>Configure with {props.productNameConnector}</a> for more information on how to continue.

### Manual set up

Setting up {props.productNameManual} manually is done through a combination of third-party devices in your premises and the Cloudflare dashboard. To be successful, you need to:

1. Read the [Prerequisites](#prerequisites) below.
2. Follow the steps in <a href={props.configureMwanManually}>Manual configuration</a>.

## Prerequisites

:::note
The list of prerequisites below is only for customers planning to connect manually to Cloudflare with a third-party device. If you plan on using {props.productNameConnector}, skip this section and refer to <a href={props.configureConnectorUrl}>Configure with {props.productNameConnector}</a>.
:::

### Use compatible tunnel endpoint routers

{props.productNameManual} relies on <a href={props.greReferenceURL}>GRE</a> and <a href={props.ipsecReferenceUrl}>IPsec tunnels</a> to transmit [packets](https://www.cloudflare.com/learning/network-layer/what-is-a-packet/) from Cloudflare's global network to your origin network. To ensure compatibility with {props.productNameManual}, the routers at your tunnel endpoints must:

- Allow configuration of at least one tunnel per Internet service provider (ISP).
- Support <GlossaryTooltip term="maximum segment size (MSS)">maximum segment size (MSS)</GlossaryTooltip> clamping.
- Support the configuration parameters for IPsec mentioned in <a href={props.ipsecReferenceConfigParams}>IPsec tunnels</a>.

### Set maximum segment size

<Render
	file="prerequisites/maximum-segment-size"
	product="networking-services"
	params={{ productName: props.productNameManual }}
/>

#### MSS clamping recommendations

##### GRE tunnels as off-ramp

<Render file="magic-wan/mtu-mss/mss-clamping-gre" product="networking-services" />

##### IPsec tunnels

<Render file="magic-wan/mtu-mss/mss-clamping-ipsec" product="networking-services"/>

:::caution[Important]
Refer to your device documentation to check if it sets IPsec MSS clamping automatically. If that is not the case and you are using IPsec inside GRE, you have to set MSS clamp manually.
:::

Refer to <a href={props.mtuReferenceURL}>Maximum transmission unit and maximum segment size</a> for more details.

### Follow router vendor guidelines

<Render
	file="prerequisites/router-vendor-guidelines-mss-settings-origin"
	product="networking-services"
/>